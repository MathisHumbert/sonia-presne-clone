/*! For license information please see main.1432000f521d9846f053.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdatecreative_boilerplate("main",{"./app/components/Canvas/Home/index.js":(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var i=s("./node_modules/gsap/index.js"),l=s("./node_modules/normalize-wheel/index.js"),r=s.n(l),o=s("./node_modules/prefix/index.js"),h=s.n(o),n=s("./node_modules/lodash/lodash.js"),a=s("./app/components/Canvas/Home/Media.js");class c{constructor({scene:e,viewport:t,screen:s,geometry:l}){this.scene=e,this.viewport=t,this.screen=s,this.geometry=l,this.galleryElement=document.querySelector(".home__gallery"),this.galleryWrapperElement=document.querySelector(".home__gallery__wrapper"),this.galleryItemElements=document.querySelectorAll(".home__gallery__item"),this.mediaElements=document.querySelectorAll(".home__gallery__media"),this.buttonElement=document.querySelector(".home__footer__view__button"),this.scroll={position:0,current:0,target:0,limit:0,last:0,velocity:0,ease:.1},this.clamp=i.gsap.utils.clamp(0,this.scroll.limit),this.itemWidth=.75*this.screen.height,this.isDown=!1,this.isAnimating=!1,this.view="main",this.transformPrefix=h()("transform"),this.createGallery(),this.onResize({viewport:t,screen:s}),this.show(),this.addEventListeners()}createGallery(){this.medias=[],(0,n.each)(this.mediaElements,((e,t)=>{const s=new a.default({element:e,index:t,scene:this.scene,viewport:this.viewport,screen:this.screen,geometry:this.geometry});this.medias.push(s)}))}show(){this.media&&this.media.show&&this.media.show()}hide(){this.media&&this.media.hide&&this.media.hide()}onResize({viewport:e,screen:t}){this.viewport=e,this.screen=t,this.scroll.limit=this.galleryWrapperElement.clientWidth-this.itemWidth,this.clamp=i.gsap.utils.clamp(0,this.scroll.limit),this.isAnimating||(0,n.each)(this.medias,(s=>{s&&s.onResize&&s.onResize({viewport:e,screen:t})}))}onTouchDown(e){this.isDown=!0,this.scroll.position=this.scroll.current,this.start=e.touches?e.touches[0].clientX:e.clientX}onTouchMove(e){if(!this.isDown)return;const t=e.touches?e.touches[0].clientX:e.clientX,s=this.start-t;this.scroll.target=this.scroll.position+s}onTouchUp(){this.isDown=!1}onWheel(e){const{pixelY:t}=r()(e);this.scroll.target+=t}onFilterClick(){"main"===this.view?this.onShowAll():this.onShowMain()}onShowMain(){console.log("onshowmain"),(0,n.each)(this.galleryItemElements,((e,t)=>{this.medias[t],e.getAttribute("data-main")}))}onShowAll(){(0,n.each)(this.galleryItemElements,((e,t)=>{this.medias[t],e.getAttribute("data-main");i.gsap.to(e,{width:"29.4vh",height:"42vh",marginRight:"calc(29.4vh / 2)"})}))}onFilterClickEnd(e){this.isAnimating=!1,this.view=e,this.clamp=i.gsap.utils.clamp(0,this.scroll.limit)}addEventListeners(){this.buttonElement.addEventListener("click",this.onFilterClick.bind(this))}update(){this.isAnimating||(this.scroll.target=this.clamp(this.scroll.target),this.scroll.current=i.gsap.utils.interpolate(this.scroll.current,this.scroll.target,this.scroll.ease),this.scroll.current=Math.floor(this.scroll.current),this.scroll.current<.01&&(this.scroll.current=0),this.galleryElement.style[this.transformPrefix]=`translateX(-${this.scroll.current}px)`,this.scroll.velocity=.05*(this.scroll.current-this.scroll.last),this.scroll.last=this.scroll.current,(0,n.each)(this.medias,(e=>{e&&e.update&&e.update({scroll:this.scroll.current,velocity:this.scroll.velocity})})))}destroy(){this.media&&this.media.mesh.removeFromParent()}}}},(function(e){e.h=()=>"5f86a2e0be73c765647f"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxhQUUvQlgsS0FBS1MsT0FBT00sU0FBc0QsS0FBMUNmLEtBQUtTLE9BQU9FLFFBQVVYLEtBQUtTLE9BQU9LLE1BRTFEZCxLQUFLUyxPQUFPSyxLQUFPZCxLQUFLUyxPQUFPRSxTQUUvQnFCLEVBQUFBLEVBQUFBLE1BQUtoQyxLQUFLK0IsUUFBU0ksSUFDYkEsR0FBU0EsRUFBTStCLFFBQ2pCL0IsRUFBTStCLE9BQU8sQ0FDWHpELE9BQVFULEtBQUtTLE9BQU9FLFFBQ3BCSSxTQUFVZixLQUFLUyxPQUFPTSxVQUUxQixJQUVKLENBS0F3RCxVQUNNdkUsS0FBS21DLE9BQ1BuQyxLQUFLbUMsTUFBTXFDLEtBQUtDLGtCQUVwQixrQkNoVEZDLEVBQW9CQyxFQUFJLElBQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jcmVhdGl2ZS1ib2lsZXJwbGF0ZS8uL2FwcC9jb21wb25lbnRzL0NhbnZhcy9Ib21lL2luZGV4LmpzIiwid2VicGFjazovL2NyZWF0aXZlLWJvaWxlcnBsYXRlL3dlYnBhY2svcnVudGltZS9nZXRGdWxsSGFzaCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnc2FwIH0gZnJvbSAnZ3NhcCc7XG5pbXBvcnQgbm9ybWFsaXplV2hlZWwgZnJvbSAnbm9ybWFsaXplLXdoZWVsJztcbmltcG9ydCBQcmVmaXggZnJvbSAncHJlZml4JztcbmltcG9ydCB7IG1hcCwgZWFjaCB9IGZyb20gJ2xvZGFzaCc7XG5cbmltcG9ydCBNZWRpYSBmcm9tICcuL01lZGlhJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9tZSB7XG4gIGNvbnN0cnVjdG9yKHsgc2NlbmUsIHZpZXdwb3J0LCBzY3JlZW4sIGdlb21ldHJ5IH0pIHtcbiAgICB0aGlzLnNjZW5lID0gc2NlbmU7XG4gICAgdGhpcy52aWV3cG9ydCA9IHZpZXdwb3J0O1xuICAgIHRoaXMuc2NyZWVuID0gc2NyZWVuO1xuICAgIHRoaXMuZ2VvbWV0cnkgPSBnZW9tZXRyeTtcblxuICAgIHRoaXMuZ2FsbGVyeUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaG9tZV9fZ2FsbGVyeScpO1xuICAgIHRoaXMuZ2FsbGVyeVdyYXBwZXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICcuaG9tZV9fZ2FsbGVyeV9fd3JhcHBlcidcbiAgICApO1xuICAgIHRoaXMuZ2FsbGVyeUl0ZW1FbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICAnLmhvbWVfX2dhbGxlcnlfX2l0ZW0nXG4gICAgKTtcbiAgICB0aGlzLm1lZGlhRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaG9tZV9fZ2FsbGVyeV9fbWVkaWEnKTtcbiAgICB0aGlzLmJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaG9tZV9fZm9vdGVyX192aWV3X19idXR0b24nKTtcblxuICAgIHRoaXMuc2Nyb2xsID0ge1xuICAgICAgcG9zaXRpb246IDAsXG4gICAgICBjdXJyZW50OiAwLFxuICAgICAgdGFyZ2V0OiAwLFxuICAgICAgbGltaXQ6IDAsXG4gICAgICBsYXN0OiAwLFxuICAgICAgdmVsb2NpdHk6IDAsXG4gICAgICBlYXNlOiAwLjEsXG4gICAgfTtcbiAgICB0aGlzLmNsYW1wID0gZ3NhcC51dGlscy5jbGFtcCgwLCB0aGlzLnNjcm9sbC5saW1pdCk7XG4gICAgdGhpcy5pdGVtV2lkdGggPSB0aGlzLnNjcmVlbi5oZWlnaHQgKiAwLjc1O1xuXG4gICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcbiAgICB0aGlzLmlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgdGhpcy52aWV3ID0gJ21haW4nO1xuXG4gICAgdGhpcy50cmFuc2Zvcm1QcmVmaXggPSBQcmVmaXgoJ3RyYW5zZm9ybScpO1xuXG4gICAgdGhpcy5jcmVhdGVHYWxsZXJ5KCk7XG5cbiAgICB0aGlzLm9uUmVzaXplKHsgdmlld3BvcnQsIHNjcmVlbiB9KTtcbiAgICB0aGlzLnNob3coKTtcblxuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNyZWF0ZUdhbGxlcnkoKSB7XG4gICAgdGhpcy5tZWRpYXMgPSBbXTtcblxuICAgIGVhY2godGhpcy5tZWRpYUVsZW1lbnRzLCAoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IG1lZGlhID0gbmV3IE1lZGlhKHtcbiAgICAgICAgZWxlbWVudCxcbiAgICAgICAgaW5kZXgsXG4gICAgICAgIHNjZW5lOiB0aGlzLnNjZW5lLFxuICAgICAgICB2aWV3cG9ydDogdGhpcy52aWV3cG9ydCxcbiAgICAgICAgc2NyZWVuOiB0aGlzLnNjcmVlbixcbiAgICAgICAgZ2VvbWV0cnk6IHRoaXMuZ2VvbWV0cnksXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5tZWRpYXMucHVzaChtZWRpYSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQW5pbWF0aW9ucy5cbiAgICovXG4gIHNob3coKSB7XG4gICAgaWYgKHRoaXMubWVkaWEgJiYgdGhpcy5tZWRpYS5zaG93KSB7XG4gICAgICB0aGlzLm1lZGlhLnNob3coKTtcbiAgICB9XG4gIH1cblxuICBoaWRlKCkge1xuICAgIGlmICh0aGlzLm1lZGlhICYmIHRoaXMubWVkaWEuaGlkZSkge1xuICAgICAgdGhpcy5tZWRpYS5oaWRlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV2ZW50cy5cbiAgICovXG4gIG9uUmVzaXplKHsgdmlld3BvcnQsIHNjcmVlbiB9KSB7XG4gICAgdGhpcy52aWV3cG9ydCA9IHZpZXdwb3J0O1xuICAgIHRoaXMuc2NyZWVuID0gc2NyZWVuO1xuXG4gICAgdGhpcy5zY3JvbGwubGltaXQgPSB0aGlzLmdhbGxlcnlXcmFwcGVyRWxlbWVudC5jbGllbnRXaWR0aCAtIHRoaXMuaXRlbVdpZHRoO1xuXG4gICAgdGhpcy5jbGFtcCA9IGdzYXAudXRpbHMuY2xhbXAoMCwgdGhpcy5zY3JvbGwubGltaXQpO1xuXG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcpIHJldHVybjtcblxuICAgIGVhY2godGhpcy5tZWRpYXMsIChtZWRpYSkgPT4ge1xuICAgICAgaWYgKG1lZGlhICYmIG1lZGlhLm9uUmVzaXplKSB7XG4gICAgICAgIG1lZGlhLm9uUmVzaXplKHtcbiAgICAgICAgICB2aWV3cG9ydCxcbiAgICAgICAgICBzY3JlZW4sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgb25Ub3VjaERvd24oZXZlbnQpIHtcbiAgICB0aGlzLmlzRG93biA9IHRydWU7XG5cbiAgICB0aGlzLnNjcm9sbC5wb3NpdGlvbiA9IHRoaXMuc2Nyb2xsLmN1cnJlbnQ7XG4gICAgdGhpcy5zdGFydCA9IGV2ZW50LnRvdWNoZXMgPyBldmVudC50b3VjaGVzWzBdLmNsaWVudFggOiBldmVudC5jbGllbnRYO1xuICB9XG5cbiAgb25Ub3VjaE1vdmUoZXZlbnQpIHtcbiAgICBpZiAoIXRoaXMuaXNEb3duKSByZXR1cm47XG5cbiAgICBjb25zdCB4ID0gZXZlbnQudG91Y2hlcyA/IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WCA6IGV2ZW50LmNsaWVudFg7XG4gICAgY29uc3QgZGlzdGFuY2UgPSB0aGlzLnN0YXJ0IC0geDtcblxuICAgIHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuc2Nyb2xsLnBvc2l0aW9uICsgZGlzdGFuY2U7XG4gIH1cblxuICBvblRvdWNoVXAoKSB7XG4gICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcbiAgfVxuXG4gIG9uV2hlZWwoZXZlbnQpIHtcbiAgICBjb25zdCB7IHBpeGVsWSB9ID0gbm9ybWFsaXplV2hlZWwoZXZlbnQpO1xuXG4gICAgdGhpcy5zY3JvbGwudGFyZ2V0ICs9IHBpeGVsWTtcbiAgfVxuXG4gIG9uRmlsdGVyQ2xpY2soKSB7XG4gICAgLy8gdGhpcy5pc0FuaW1hdGluZyA9IHRydWU7XG5cbiAgICBpZiAodGhpcy52aWV3ID09PSAnbWFpbicpIHtcbiAgICAgIHRoaXMub25TaG93QWxsKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub25TaG93TWFpbigpO1xuICAgIH1cblxuICAgIHJldHVybjtcblxuICAgIGVhY2godGhpcy5nYWxsZXJ5SXRlbUVsZW1lbnRzLCAoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IG1lZGlhID0gdGhpcy5tZWRpYXNbaW5kZXhdO1xuICAgICAgbGV0IHRlbXBTY2FsZSA9IHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHRoaXMudmlldyA9PT0gJ21haW4nICYmIGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLW1haW4nKSAhPT0gJ3RydWUnKSB7XG4gICAgICAgIGdzYXAuc2V0KGl0ZW0sIHtcbiAgICAgICAgICB3aWR0aDogJzQydmgnLFxuICAgICAgICAgIGhlaWdodDogJzYwdmgnLFxuICAgICAgICAgIG1hcmdpblJpZ2h0OiAnMzN2aCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1lZGlhLm1lc2guc2NhbGUueCA9XG4gICAgICAgICAgKG1lZGlhLnZpZXdwb3J0LndpZHRoICogbWVkaWEuYm91bmRzLndpZHRoKSAvIG1lZGlhLnNjcmVlbi53aWR0aDtcbiAgICAgICAgbWVkaWEubWVzaC5zY2FsZS55ID1cbiAgICAgICAgICAobWVkaWEudmlld3BvcnQuaGVpZ2h0ICogbWVkaWEuYm91bmRzLmhlaWdodCkgLyBtZWRpYS5zY3JlZW4uaGVpZ2h0O1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy52aWV3ID09PSAnYWxsJyAmJiBpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1tYWluJykgIT09ICd0cnVlJykge1xuICAgICAgICBnc2FwLnNldChpdGVtLCB7XG4gICAgICAgICAgd2lkdGg6ICc0MnZoJyxcbiAgICAgICAgICBoZWlnaHQ6ICc2MHZoJyxcbiAgICAgICAgICBtYXJnaW5SaWdodDogJzMzdmgnLFxuICAgICAgICB9KTtcblxuICAgICAgICB0ZW1wU2NhbGUgPSB7XG4gICAgICAgICAgeDogKG1lZGlhLnZpZXdwb3J0LndpZHRoICogbWVkaWEuYm91bmRzLndpZHRoKSAvIG1lZGlhLnNjcmVlbi53aWR0aCxcbiAgICAgICAgICB5OlxuICAgICAgICAgICAgKG1lZGlhLnZpZXdwb3J0LmhlaWdodCAqIG1lZGlhLmJvdW5kcy5oZWlnaHQpIC8gbWVkaWEuc2NyZWVuLmhlaWdodCxcbiAgICAgICAgfTtcblxuICAgICAgICBnc2FwLnNldChpdGVtLCB7IHdpZHRoOiAwLCBtYXJnaW5SaWdodDogMCB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdzYXAuc2V0KGl0ZW0sIHtcbiAgICAgICAgICB3aWR0aDogJzQydmgnLFxuICAgICAgICAgIGhlaWdodDogJzYwdmgnLFxuICAgICAgICAgIG1hcmdpblJpZ2h0OiAnMzN2aCcsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy52aWV3ID09PSAnbWFpbicpIHtcbiAgICAgICAgZ3NhcC5zZXQoaXRlbSwge1xuICAgICAgICAgIHdpZHRoOiAnMjkuNHZoJyxcbiAgICAgICAgICBoZWlnaHQ6ICc0MnZoJyxcbiAgICAgICAgICBtYXJnaW5SaWdodDogJ2NhbGMoMjkuNHZoIC8gMiknLFxuICAgICAgICB9KTtcblxuICAgICAgICBtZWRpYS5zaG93QWxsKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtZWRpYS5zaG93TWFpbih0ZW1wU2NhbGUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMudmlldyA9PT0gJ21haW4nKSB7XG4gICAgICAvLyB0aGlzLml0ZW1XaWR0aCA9IHRoaXMuc2NyZWVuLmhlaWdodCAqIDAuNDQxO1xuXG4gICAgICAvLyBjb25zdCBvbGRTY3JvbGxMaW1pdCA9IHRoaXMuc2Nyb2xsLmxpbWl0O1xuXG4gICAgICAvLyB0aGlzLnNjcm9sbC5saW1pdCA9XG4gICAgICAvLyAgIHRoaXMuZ2FsbGVyeVdyYXBwZXJFbGVtZW50LmNsaWVudFdpZHRoIC0gdGhpcy5pdGVtV2lkdGg7XG4gICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNjcm9sbC5jdXJyZW50KTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKG9sZFNjcm9sbExpbWl0IC0gdGhpcy5zY3JvbGwubGltaXQpO1xuXG4gICAgICBnc2FwLmRlbGF5ZWRDYWxsKDEsICgpID0+IHtcbiAgICAgICAgdGhpcy5vbkZpbHRlckNsaWNrRW5kKCdhbGwnKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBnc2FwLmRlbGF5ZWRDYWxsKDEsICgpID0+IHtcbiAgICAgICAgdGhpcy5vbkZpbHRlckNsaWNrRW5kKCdtYWluJyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBvblNob3dNYWluKCkge1xuICAgIGNvbnNvbGUubG9nKCdvbnNob3dtYWluJyk7XG4gICAgZWFjaCh0aGlzLmdhbGxlcnlJdGVtRWxlbWVudHMsIChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgbWVkaWEgPSB0aGlzLm1lZGlhc1tpbmRleF07XG4gICAgICBjb25zdCBpc01haW4gPSBpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1tYWluJykgPT09ICd0cnVlJztcbiAgICB9KTtcbiAgfVxuXG4gIG9uU2hvd0FsbCgpIHtcbiAgICBlYWNoKHRoaXMuZ2FsbGVyeUl0ZW1FbGVtZW50cywgKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBtZWRpYSA9IHRoaXMubWVkaWFzW2luZGV4XTtcbiAgICAgIGNvbnN0IGlzTWFpbiA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLW1haW4nKSA9PT0gJ3RydWUnO1xuXG4gICAgICBpZiAoIWlzTWFpbikge1xuICAgICAgICAvLyBnc2FwLnNldChpdGVtLCB7XG4gICAgICAgIC8vICAgd2lkdGg6ICc0MnZoJyxcbiAgICAgICAgLy8gICBoZWlnaHQ6ICc2MHZoJyxcbiAgICAgICAgLy8gICBtYXJnaW5SaWdodDogJzMzdmgnLFxuICAgICAgICAvLyB9KTtcbiAgICAgICAgLy8gbWVkaWEubWVzaC5zY2FsZS54ID1cbiAgICAgICAgLy8gICAobWVkaWEudmlld3BvcnQud2lkdGggKiBtZWRpYS5ib3VuZHMud2lkdGgpIC8gbWVkaWEuc2NyZWVuLndpZHRoO1xuICAgICAgICAvLyBtZWRpYS5tZXNoLnNjYWxlLnkgPVxuICAgICAgICAvLyAgIChtZWRpYS52aWV3cG9ydC5oZWlnaHQgKiBtZWRpYS5ib3VuZHMuaGVpZ2h0KSAvIG1lZGlhLnNjcmVlbi5oZWlnaHQ7XG4gICAgICB9XG5cbiAgICAgIGdzYXAudG8oaXRlbSwge1xuICAgICAgICB3aWR0aDogJzI5LjR2aCcsXG4gICAgICAgIGhlaWdodDogJzQydmgnLFxuICAgICAgICBtYXJnaW5SaWdodDogJ2NhbGMoMjkuNHZoIC8gMiknLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBvbkZpbHRlckNsaWNrRW5kKG5ld1ZpZXcpIHtcbiAgICB0aGlzLmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cbiAgICB0aGlzLnZpZXcgPSBuZXdWaWV3O1xuXG4gICAgdGhpcy5jbGFtcCA9IGdzYXAudXRpbHMuY2xhbXAoMCwgdGhpcy5zY3JvbGwubGltaXQpO1xuICB9XG5cbiAgYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5idXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbkZpbHRlckNsaWNrLmJpbmQodGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIExvb3AuXG4gICAqL1xuICB1cGRhdGUoKSB7XG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcpIHJldHVybjtcblxuICAgIHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuY2xhbXAodGhpcy5zY3JvbGwudGFyZ2V0KTtcblxuICAgIHRoaXMuc2Nyb2xsLmN1cnJlbnQgPSBnc2FwLnV0aWxzLmludGVycG9sYXRlKFxuICAgICAgdGhpcy5zY3JvbGwuY3VycmVudCxcbiAgICAgIHRoaXMuc2Nyb2xsLnRhcmdldCxcbiAgICAgIHRoaXMuc2Nyb2xsLmVhc2VcbiAgICApO1xuXG4gICAgdGhpcy5zY3JvbGwuY3VycmVudCA9IE1hdGguZmxvb3IodGhpcy5zY3JvbGwuY3VycmVudCk7XG5cbiAgICBpZiAodGhpcy5zY3JvbGwuY3VycmVudCA8IDAuMDEpIHtcbiAgICAgIHRoaXMuc2Nyb2xsLmN1cnJlbnQgPSAwO1xuICAgIH1cblxuICAgIHRoaXMuZ2FsbGVyeUVsZW1lbnQuc3R5bGVbXG4gICAgICB0aGlzLnRyYW5zZm9ybVByZWZpeFxuICAgIF0gPSBgdHJhbnNsYXRlWCgtJHt0aGlzLnNjcm9sbC5jdXJyZW50fXB4KWA7XG5cbiAgICB0aGlzLnNjcm9sbC52ZWxvY2l0eSA9ICh0aGlzLnNjcm9sbC5jdXJyZW50IC0gdGhpcy5zY3JvbGwubGFzdCkgKiAwLjA1O1xuXG4gICAgdGhpcy5zY3JvbGwubGFzdCA9IHRoaXMuc2Nyb2xsLmN1cnJlbnQ7XG5cbiAgICBlYWNoKHRoaXMubWVkaWFzLCAobWVkaWEpID0+IHtcbiAgICAgIGlmIChtZWRpYSAmJiBtZWRpYS51cGRhdGUpIHtcbiAgICAgICAgbWVkaWEudXBkYXRlKHtcbiAgICAgICAgICBzY3JvbGw6IHRoaXMuc2Nyb2xsLmN1cnJlbnQsXG4gICAgICAgICAgdmVsb2NpdHk6IHRoaXMuc2Nyb2xsLnZlbG9jaXR5LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95LlxuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICBpZiAodGhpcy5tZWRpYSkge1xuICAgICAgdGhpcy5tZWRpYS5tZXNoLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gVE9ET1xuLy8gYXV0b0FscGhhIGZvcm0gMCB0byAxIGlmIGlzIG5vdCBkaXNwbGF5XG4vLyBvbmx5IGNoYW5nZSB3aWR0aCBhbmQgbWFyZ2luIGZyb20gMCB0byB2aFxuLy8gY2hhbmdlIGhlaWdodCBmcm9tIGN1cnJlbnQgdG8gbmV4dFxuLy8gYmxvY2sgY2xpY2sgaWYgaXMgYW5pbWF0aW5nXG4vLyB1cGRhdGUgbGltaXQgb24gY2xpY2sgc3RhcnRcbi8vIGJsb2NrIHNjcm9sbCBvbiBpc0FuaW1hdGluZ1xuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5oID0gKCkgPT4gKFwiNWY4NmEyZTBiZTczYzc2NTY0N2ZcIikiXSwibmFtZXMiOlsiSG9tZSIsImNvbnN0cnVjdG9yIiwic2NlbmUiLCJ2aWV3cG9ydCIsInNjcmVlbiIsImdlb21ldHJ5IiwidGhpcyIsImdhbGxlcnlFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2FsbGVyeVdyYXBwZXJFbGVtZW50IiwiZ2FsbGVyeUl0ZW1FbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJtZWRpYUVsZW1lbnRzIiwiYnV0dG9uRWxlbWVudCIsInNjcm9sbCIsInBvc2l0aW9uIiwiY3VycmVudCIsInRhcmdldCIsImxpbWl0IiwibGFzdCIsInZlbG9jaXR5IiwiZWFzZSIsImNsYW1wIiwiZ3NhcCIsInV0aWxzIiwiaXRlbVdpZHRoIiwiaGVpZ2h0IiwiaXNEb3duIiwiaXNBbmltYXRpbmciLCJ2aWV3IiwidHJhbnNmb3JtUHJlZml4IiwiUHJlZml4IiwiY3JlYXRlR2FsbGVyeSIsIm9uUmVzaXplIiwic2hvdyIsImFkZEV2ZW50TGlzdGVuZXJzIiwibWVkaWFzIiwiZWFjaCIsImVsZW1lbnQiLCJpbmRleCIsIm1lZGlhIiwiTWVkaWEiLCJwdXNoIiwiaGlkZSIsImNsaWVudFdpZHRoIiwib25Ub3VjaERvd24iLCJldmVudCIsInN0YXJ0IiwidG91Y2hlcyIsImNsaWVudFgiLCJvblRvdWNoTW92ZSIsIngiLCJkaXN0YW5jZSIsIm9uVG91Y2hVcCIsIm9uV2hlZWwiLCJwaXhlbFkiLCJub3JtYWxpemVXaGVlbCIsIm9uRmlsdGVyQ2xpY2siLCJvblNob3dBbGwiLCJvblNob3dNYWluIiwiY29uc29sZSIsImxvZyIsIml0ZW0iLCJnZXRBdHRyaWJ1dGUiLCJ0byIsIndpZHRoIiwibWFyZ2luUmlnaHQiLCJvbkZpbHRlckNsaWNrRW5kIiwibmV3VmlldyIsImFkZEV2ZW50TGlzdGVuZXIiLCJiaW5kIiwidXBkYXRlIiwiaW50ZXJwb2xhdGUiLCJNYXRoIiwiZmxvb3IiLCJzdHlsZSIsImRlc3Ryb3kiLCJtZXNoIiwicmVtb3ZlRnJvbVBhcmVudCIsIl9fd2VicGFja19yZXF1aXJlX18iLCJoIl0sInNvdXJjZVJvb3QiOiIifQ==